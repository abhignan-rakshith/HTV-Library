<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline'; media-src 'self' data: blob: https: http:; connect-src 'self' https: wss: http:; img-src 'self' data: https: http:;" />
    <title>HTV Library</title>
    <link rel="stylesheet" href="index.css" />
  </head>
  <body>
    <!-- Main webview for browsing the site -->
    <webview
      id="webview"
      src="https://hanime.tv"
      allowfullscreen
      webpreferences="allowRunningInsecureContent=yes, javascript=yes"
      useragent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"
      partition="persist:main">
    </webview>

    <!-- Floating action button for library operations -->
    <button id="fab" class="floating-action-button" title="Library">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
        <path fill="none" d="M0 0h24v24H0z"/>
        <path d="M4 4c0-1.1.9-2 2-2h12c1.1 0 2 .9 2 2v16c0 1.1-.9 2-2 2H6c-1.1 0-2-.9-2-2V4zm2 0v16h12V4H6z" fill="currentColor"/>
        <path d="M8 5h8v2H8zM8 9h8v2H8zM8 13h8v2H8z" fill="currentColor"/>
      </svg>
    </button>

    <!-- Notification snackbar -->
    <div id="snackbar" class="snackbar"></div>

    <!-- Data modal for displaying scraped content -->
    <div id="dataModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 class="modal-title">Media Details</h2>
          <button id="closeModal" class="close-button">&times;</button>
        </div>
        <table class="data-table">
          <tr>
            <td>Title</td>
            <td><input type="text" id="titleField" class="data-field" readonly></td>
          </tr>
          <tr>
            <td>Views</td>
            <td><input type="text" id="viewsField" class="data-field" readonly></td>
          </tr>
          <tr>
            <td>URL</td>
            <td><input type="text" id="urlField" class="data-field" readonly></td>
          </tr>
          <tr>
            <td>Thumbnail</td>
            <td>
              <img id="thumbnailPreview" class="data-thumbnail" src="" alt="Thumbnail preview">
              <input type="text" id="thumbnailField" class="data-field" readonly>
            </td>
          </tr>
          <tr>
            <td>Brand</td>
            <td><input type="text" id="brandField" class="data-field" readonly></td>
          </tr>
          <tr>
            <td>Release Date</td>
            <td><input type="text" id="releaseDateField" class="data-field" readonly></td>
          </tr>
          <tr>
            <td>Tags</td>
            <td><div id="tagsContainer" class="tags-container"></div></td>
          </tr>
          <tr>
            <td>Plot</td>
            <td><textarea id="plotField" class="data-field" rows="6"></textarea></td>
          </tr>
        </table>
        <div class="action-buttons">
          <button id="cancelButton" class="action-button cancel-button">Cancel</button>
          <button id="saveButton" class="action-button save-button">Save to Library</button>
        </div>
      </div>
    </div>

    <!-- Image Save Modal - Add this after the existing dataModal in index.html -->
    <div id="imageSaveModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 class="modal-title">Save Images to Library</h2>
          <button id="closeImageModal" class="close-button">&times;</button>
        </div>
        <table class="data-table">
          <tr>
            <td>Images Selected</td>
            <td><span id="imageCountDisplay" class="image-count-badge">0</span></td>
          </tr>
          <tr>
            <td>Tag *</td>
            <td><input type="text" id="imageTagField" class="data-field" placeholder="Enter a tag for these images" required maxlength="50"></td>
          </tr>
          <tr>
            <td>Comments</td>
            <td><textarea id="imageCommentsField" class="data-field" rows="4" placeholder="Optional comments about these images" maxlength="500"></textarea></td>
          </tr>
        </table>
        <div class="action-buttons">
          <button id="cancelImageButton" class="action-button cancel-button">Cancel</button>
          <button id="saveImageButton" class="action-button save-button">Save to Library</button>
        </div>
      </div>
    </div>

    <!-- Load application modules -->
    <script src="renderer/ui-manager.js"></script>
    <script src="renderer/scraper.js"></script>
    <script src="renderer/app-controller.js"></script>
    
    <!-- Initialize application -->
    <script>
      new AppController();
    </script>
  </body>
</html>